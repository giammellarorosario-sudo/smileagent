<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analytics - SmileAgent</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#0ea5e9',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 dark:bg-gray-800">
  <div class="flex min-h-screen">
    <%- include('../partials/sidebar', { currentPage, studioNome }) %>

    <main class="flex-1 p-8">
      <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-6">Analytics & KPI</h1>

        <!-- KPI Cards -->
        <div class="grid grid-cols-4 gap-4 mb-6">
          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-600 dark:text-gray-400">Pazienti</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1"><%= stats.pazienti %></p>
              </div>
              <span class="material-symbols-outlined text-blue-500 text-4xl">group</span>
            </div>
            <p class="text-xs text-green-600 mt-2">↑ +12% vs mese scorso</p>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-600 dark:text-gray-400">Appuntamenti</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1"><%= stats.appuntamenti %></p>
              </div>
              <span class="material-symbols-outlined text-green-500 text-4xl">calendar_month</span>
            </div>
            <p class="text-xs text-green-600 mt-2">↑ +8% vs mese scorso</p>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-600 dark:text-gray-400">Analisi AI</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1"><%= stats.analisi %></p>
              </div>
              <span class="material-symbols-outlined text-purple-500 text-4xl">analytics</span>
            </div>
            <p class="text-xs text-green-600 mt-2">↑ +156% vs mese scorso</p>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-600 dark:text-gray-400">Chat AI</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1"><%= stats.conversazioni %></p>
              </div>
              <span class="material-symbols-outlined text-primary text-4xl">smart_toy</span>
            </div>
            <p class="text-xs text-green-600 mt-2">↑ +45% vs mese scorso</p>
          </div>
        </div>

        <!-- Grafici -->
        <div class="grid grid-cols-2 gap-6">
          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Trend Pazienti</h2>
            <div class="h-64 flex items-center justify-center text-gray-400">
              <div class="text-center">
                <span class="material-symbols-outlined text-6xl">show_chart</span>
                <p class="mt-2">Grafico trend in sviluppo</p>
              </div>
            </div>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Appuntamenti per Tipo</h2>
            <div class="h-64 flex items-center justify-center text-gray-400">
              <div class="text-center">
                <span class="material-symbols-outlined text-6xl">pie_chart</span>
                <p class="mt-2">Grafico distribuzione in sviluppo</p>
              </div>
            </div>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Utilizzo AI</h2>
            <div class="space-y-3">
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Gemini Chat</span>
                  <span class="text-gray-900 dark:text-white font-semibold"><%= stats.conversazioni %> sessioni</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div class="bg-primary h-2 rounded-full" style="width: 75%"></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Gemini Vision</span>
                  <span class="text-gray-900 dark:text-white font-semibold"><%= stats.analisi %> analisi</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div class="bg-purple-500 h-2 rounded-full" style="width: 60%"></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Imagen 3</span>
                  <span class="text-gray-900 dark:text-white font-semibold">12 immagini</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div class="bg-green-500 h-2 rounded-full" style="width: 12%"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-white dark:bg-gray-900 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Performance Studio</h2>
            <div class="space-y-4">
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-600 dark:text-gray-400">Tasso Occupazione</span>
                <span class="text-lg font-bold text-green-600">87%</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-600 dark:text-gray-400">No-Show Rate</span>
                <span class="text-lg font-bold text-red-600">5%</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-600 dark:text-gray-400">Retention Rate</span>
                <span class="text-lg font-bold text-blue-600">92%</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-600 dark:text-gray-400">Soddisfazione Media</span>
                <span class="text-lg font-bold text-primary">4.8/5</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</body>
</html>
